<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.maitaidan.dao.SignMapper">

    <resultMap id="LogMap" type="com.maitaidan.model.Log">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="userId" property="userId" jdbcType="VARCHAR"/>
        <result column="signconfigId" property="SignConfigId" jdbcType="VARCHAR"/>
        <result column="content" property="content" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <select id="getSignConfigByUserId" parameterType="int" resultType="com.maitaidan.model.SignConfig">
        select * from SignConfig where userId=#{userId}
    </select>

    <select id="getAllSignConfig" resultType="com.maitaidan.model.SignConfig">
        select * from SignConfig
    </select>

    <insert id="addSignConfig" parameterType="com.maitaidan.model.SignConfig">
        insert into SignConfig (userId,url,params,cookie,remark) VALUES (#{userId}, #{url}, #{params}, #{cookie}, #{remark})
    </insert>

    <!--日志-->
    <insert id="addSignLog" parameterType="com.maitaidan.model.Log">
        INSERT  INTO SignLog (userId,signconfigId,content) VALUES (#{userId},#{SignConfigId},#{content})
    </insert>

    <insert id="addBatchSignLog">
        INSERT INTO SignLog (userId,signconfigId,content)
        VALUES
        <foreach collection="logList" separator="," item="log">
            (#{log.userId},#{log.signConfigId},#{log.content})
        </foreach>
    </insert>

    <select id="getLogByUserId" parameterType="int" resultType="ArrayList" resultMap="LogMap">
        SELECT id,userId,signconfigId,content,create_time FROM SignLog WHERE userId=#{userId}
    </select>
</mapper>